<!DOCTYPE html>
<HTML>
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment-with-locales.min.js" integrity="sha512-4F1cxYdMiAW98oomSLaygEwmCnIP38pb4Kx70yQYqRwLVCs3DbRumfBq82T08g/4LJ/smbFGFpmeFlQgoDccgg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <script>
            async function initialLoad() {
                const url = 'http://localhost:3000/api/v1/recently_played';
                await axios
                    .get(url)
                    .then((response) => {
                        const table = document.getElementById('recently-played-table-body');
                        const songs = response.data['songs'];
                        songs.forEach((song) => {
                            const songRow = document.createElement('tr');
                            const data = [moment(Date.parse(song['played_at'])).format('MMM-DD-YYYY : hh:mm A'), song['song_name'], song['artist_names'], song['album_name']];
                            data.forEach((column) => {
                                const songRowData = document.createElement('td');
                                const textNode = document.createTextNode(column);
                                songRowData.appendChild(textNode);
                                songRow.appendChild(songRowData);
                            });
                            table.appendChild(songRow);
                        });
                    })
                    .catch((error) => {
                        console.log('There was an error getting the recently played songs');
                        console.log(error);
                        console.log('----------------------------------------------------');
                    })
            }
        </script>
    </head>

    <body onload='initialLoad()' style='background-color: black;'>
        <div style='justify-content: center; margin: auto; width: 70%;'>
            <table class='table table-dark table-striped'>
                <thead>
                    <tr>
                        <th>Played At</th>
                        <th>Song</th>
                        <th>Artist(s)</th>
                        <th>Album</th>
                    </tr>
                </thead>
                <tbody id='recently-played-table-body'>
    
                </tbody>
            </table>
        </div>
    </body>
</HTML>